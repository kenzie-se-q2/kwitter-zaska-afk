(this["webpackJsonpkwitter-starter"]=this["webpackJsonpkwitter-starter"]||[]).push([[0],{40:function(e,t,n){},44:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(18),c=n.n(s),i=(n(40),n(6)),o=n(17),u=n(4),j=n(5),l=n(8),d="https://socialapp-api.herokuapp.com/",b=function(e,t){return fetch(d+"auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})}).then((function(e){return e.json()}))},h=function(e,t){return fetch("".concat(d,"messages?limit=").concat(e,"&offset=").concat(t)).then((function(e){return e.json()}))},m=n(35),p=n(33),f=n(27),O="LOGOUT",x="LOGIN",g="SET_MESSAGES",v="SET_REDIRECTING",y="SET_LIMIT",k="ADD_LIKE",w="REMOVE_LIKE",S=Object(p.a)(Object(f.devtools)(Object(f.redux)((function(e,t){switch(t.type){case x:return Object(u.a)(Object(u.a)({},e),{},{user:{username:t.payload.username,token:t.payload.token}});case O:return Object(u.a)(Object(u.a)({},e),{},{user:{}});case g:return Object(u.a)(Object(u.a)({},e),{},{messages:t.payload.messages});case v:return Object(u.a)(Object(u.a)({},e),{},{isRedirecting:!e.isRedirecting});case y:return Object(u.a)(Object(u.a)({},e),{},{limit:t.payload.limit});case k:return console.log(t.payload),Object(u.a)(Object(u.a)({},e),{},{likes:[].concat(Object(m.a)(e.likes),[t.payload.like])});case w:return Object(u.a)(Object(u.a)({},e),{},{likes:t.payload.likes});default:return e}}),{user:{token:""},messages:[],limit:15,isRedirecting:!1}))),N=(n(44),n(1));var C=function(){var e=S((function(e){return e.dispatch})),t=S((function(e){return e.isRedirecting})),n=Object(a.useState)({username:"",password:""}),r=Object(j.a)(n,2),s=r[0],c=r[1];Object(a.useEffect)((function(){return window.addEventListener("message",d),function(){window.removeEventListener("message",d)}}),[]);var d=function(t){void 0!==t.data.username&&(e({type:x,payload:t.data}),e({type:v}))},h=function(e){var t=e.target.name,n=e.target.value;c((function(e){return Object(u.a)(Object(u.a)({},e),{},Object(o.a)({},t,n))}))};return Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)("div",{id:"login",children:[Object(N.jsxs)("form",{id:"login-form",onSubmit:function(t){t.preventDefault(),b(s.username,s.password).then((function(t){return void 0===t.message?e({type:x,payload:t}):(alert(t.message),!1)})).then((function(t){t&&e({type:v})}))},children:[Object(N.jsx)("label",{htmlFor:"username",children:"Username"}),Object(N.jsx)("input",{type:"text",name:"username",value:s.username,autoFocus:!0,required:!0,onChange:h}),Object(N.jsx)("label",{htmlFor:"password",children:"Password"}),Object(N.jsx)("input",{type:"password",name:"password",value:s.password,required:!0,onChange:h}),Object(N.jsx)("button",{type:"submit",children:"Login"}),Object(N.jsx)("button",{onClick:function(e){window.open("https://socialapp-api.herokuapp.com/auth/google/login")},children:"Login in with Google"}),Object(N.jsxs)("p",{children:["Don't have an account? Sign up ",Object(N.jsx)(l.b,{to:"/register",children:"here!"})]})]}),t&&Object(N.jsx)(i.a,{to:"/messages"})]})})};var E=function(e){return Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)("div",{id:"title",children:[Object(N.jsx)("div",{id:"menu",children:Object(N.jsx)("h1",{id:"header",children:"Kwitter"})}),Object(N.jsx)(C,{})]})})},L=function(e){var t=S((function(e){return e.dispatch})),n=S((function(e){return e.isRedirecting})),r=Object(a.useState)({username:"",displayName:"",password:""}),s=Object(j.a)(r,2),c=s[0],h=s[1],m=function(e){var t=e.target.name,n=e.target.value;h((function(e){return Object(u.a)(Object(u.a)({},e),{},Object(o.a)({},t,n))}))};return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)("form",{id:"signup-form",onSubmit:function(e){var n,a,r;e.preventDefault(),(n=c.username,a=c.password,r=c.displayName,fetch(d+"users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,displayName:r,password:a})}).then((function(e){return e.json()}))).then((function(){return b(c.username,c.password)})).then((function(e){return void 0===e.message?t({type:x,payload:e}):(alert(e.message),!1)})).then((function(e){if(e)return t({type:v})}))},children:[Object(N.jsx)("label",{htmlFor:"username",children:"Username"}),Object(N.jsx)("input",{type:"text",name:"username",value:c.username,autoFocus:!0,required:!0,onChange:m}),Object(N.jsx)("label",{htmlFor:"displayName",children:"Display Name"}),Object(N.jsx)("input",{type:"text",name:"displayName",value:c.displayName,required:!0,onChange:m}),Object(N.jsx)("label",{htmlFor:"password",children:"Password"}),Object(N.jsx)("input",{type:"password",name:"password",value:c.password,required:!0,onChange:m}),Object(N.jsx)("button",{type:"submit",children:"Sign Up"})]}),Object(N.jsxs)("p",{children:["Already have an account? Login ",Object(N.jsx)(l.b,{to:"/",children:"here!"}),n&&Object(N.jsx)(i.a,{to:"/"})]})]})};var T=function(e){return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)("p",{children:["Page not found for ",e.location.pathname]}),Object(N.jsx)(l.b,{to:"/",children:"Go Home"})]})},F=n(30);n(24);var P=function(e){var t=S((function(e){return e.user})),n=S((function(e){return e.dispatch}));return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(F.a,{fixed:"top"}),Object(N.jsx)(F.a,{bg:"dark",variant:"dark"}),Object(N.jsx)("button",{onClick:function(e){var a;(a=t.token,fetch(d+"auth/logout",{headers:{Authorization:"Bearer "+a}}).then((function(e){return e.json()}))).then((function(){return n({type:O})})).then(n({type:v})).then((function(){return n({type:y,payload:{limit:15}})}))},children:"Logout"}),Object(N.jsx)(l.b,{to:"/profile/".concat(t.username),children:Object(N.jsx)("button",{children:"Profile"})}),Object(N.jsx)(l.b,{to:"/messages",children:Object(N.jsx)("button",{children:"Message Board"})}),Object(N.jsx)(l.b,{to:"/topten",children:Object(N.jsx)("button",{children:"Top Posts"})})]})},D=function(e){var t=e.onChange,n=e.src;return Object(N.jsxs)("label",{htmlFor:"photo-upload",className:"custom-file-upload fas",children:[Object(N.jsx)("div",{className:"img-wrap img-upload",children:Object(N.jsx)("img",{for:"photo-upload",src:n})}),Object(N.jsx)("input",{id:"photo-upload",type:"file",onChange:t})]})},A=function(e){var t=e.onChange,n=e.value;return Object(N.jsxs)("div",{className:"field",children:[Object(N.jsx)("label",{htmlFor:"name",children:"name:"}),Object(N.jsx)("input",{id:"name",type:"text",onChange:t,minLength:"3",maxLength:"20",value:n,required:!0})]})},R=function(e){var t=e.onChange,n=e.value;return Object(N.jsxs)("div",{className:"field",children:[Object(N.jsx)("label",{htmlFor:"status",children:"status:"}),Object(N.jsx)("input",{id:"status",type:"text",onChange:t,maxLength:"255",value:n,required:!0})]})},B=function(e){var t=e.onChange,n=e.value;return Object(N.jsxs)("div",{className:"field",children:[Object(N.jsx)("label",{htmlFor:"password",children:"Password:"}),Object(N.jsx)("input",{id:"password",type:"password",onChange:t,minLength:"3",maxLength:"20",value:n,required:!0})]})},I=function(e){var t=e.onSubmit,n=e.src,a=e.name,r=e.status,s=e.canEdit,c=e.username;return Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)("div",{className:"profilecard",children:[Object(N.jsxs)("h3",{children:[a,"'s Profile Page"]}),Object(N.jsxs)("form",{onSubmit:t,children:[Object(N.jsx)("label",{className:"custom-file-upload fas",children:Object(N.jsx)("div",{className:"img-wrap",children:Object(N.jsx)("img",{width:"200px",for:"photo-upload",src:n,alt:"".concat(c,"'s Profile Picture")})})}),Object(N.jsx)("div",{className:"name",children:a}),Object(N.jsxs)("div",{className:"username",children:["@",c]}),Object(N.jsx)("div",{className:"status",children:r}),s&&Object(N.jsxs)("button",{type:"submit",className:"edit",children:["Edit Profile"," "]})]})]})})},z=function(e){var t=e.onSubmit,n=e.changeActive,a=e.children,r=e.handleDelete;return Object(N.jsx)("div",{className:"profilecard",children:Object(N.jsxs)("form",{onSubmit:t,children:[a,Object(N.jsxs)("button",{type:"submit",className:"save",children:["Save"," "]}),Object(N.jsx)("button",{onClick:r,children:"Delete Account"}),Object(N.jsx)("button",{onClick:n,children:"Back"})]})})};var q=function(e){var t=Object(a.useState)(""),n=Object(j.a)(t,2),r=n[0],s=n[1],c=Object(a.useState)(""),o=Object(j.a)(c,2),l=o[0],b=o[1],h=Object(a.useState)(""),m=Object(j.a)(h,2),p=m[0],f=m[1],x=Object(a.useState)(""),g=Object(j.a)(x,2),y=g[0],k=g[1],w=Object(a.useState)(!1),C=Object(j.a)(w,2),E=C[0],L=C[1],T=Object(a.useState)(!1),F=Object(j.a)(T,2),q=F[0],U=F[1],J=Object(a.useState)({password:"",displayName:"",about:""}),M=Object(j.a)(J,2),G=M[0],_=M[1],K=S((function(e){return e.isRedirecting})),H=S((function(e){return e.user})),V=S((function(e){return e.dispatch}));function W(e){var t=new FileReader,n=e.target.files[0];t.onloadend=function(){n.size<=2e5?(k(t.result),function(e,t,n){var a=new FormData;a.append("picture",t),fetch(d+"users/".concat(e,"/picture"),{method:"PUT",headers:{Authorization:"Bearer "+n},body:a})}(H.username,n,H.token)):alert("Image cannot be larger than 200KB")},t.readAsDataURL(n)}function Q(e){e.preventDefault(),function(e,t,n,a,r){return fetch(d+"users/".concat(e),{method:"PATCH",headers:{Authorization:"Bearer "+r,"Content-Type":"application/json"},body:JSON.stringify({password:t,about:n,displayName:a})}).then((function(e){return e.json()}))}(H.username,G.password,G.about,G.displayName,H.token).then((function(e){if(200===e.statusCode){var t=e.user;s(t.displayName),b(t.username),f(t.about),k("https://socialapp-api.herokuapp.com".concat(t.pictureLocation)),_({password:"",displayName:"",about:"",picture:{}})}})),L((function(e){return!e}))}function X(e){(function(e,t){return fetch(d+"users/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer "+t}}).then((function(e){return e.json()}))})(H.username,H.token).then(V({type:O})).then(V({type:v}))}function Y(){L((function(e){return!e}))}return Object(a.useEffect)((function(){(function(e){return fetch(d+"users/".concat(e)).then((function(e){return e.json()}))})(e.location.pathname.slice(9)).then((function(e){e.user.username===H.username&&U(!0),s(e.user.displayName),b(e.user.username),k("https://socialapp-api.herokuapp.com".concat(e.user.pictureLocation)),f(e.user.about)}))}),[e.location.pathname]),Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(P,{}),Object(N.jsx)("div",{className:"profilebody",children:E?Object(N.jsxs)(z,{onSubmit:function(e){return Q(e)},changeActive:function(e){return Y()},handleDelete:function(e){return X()},children:[Object(N.jsx)(D,{onChange:function(e){return W(e)},src:y}),Object(N.jsx)(A,{onChange:function(e){return function(e){var t=e.target.value;_((function(e){return Object(u.a)(Object(u.a)({},e),{},{displayName:t})}))}(e)},value:G.displayName}),Object(N.jsx)(B,{onChange:function(e){return function(e){var t=e.target.value;_((function(e){return Object(u.a)(Object(u.a)({},e),{},{password:t})}))}(e)},value:G.password}),Object(N.jsx)(R,{onChange:function(e){return function(e){var t=e.target.value;_((function(e){return Object(u.a)(Object(u.a)({},e),{},{about:t})}))}(e)},value:G.about})]}):Object(N.jsx)(I,{onSubmit:function(e){return Y()},src:y,name:r,username:l,status:p,canEdit:q})}),!K&&Object(N.jsx)(i.a,{to:"/"})]})},U=(n(51),n(15)),J=n(20),M=function(e){var t=Object(a.useState)("Like"),n=Object(j.a)(t,2),r=n[0],s=n[1],c=Object(a.useState)(!0),i=Object(j.a)(c,2),o=i[0],u=i[1],l=S((function(e){return e.messages})),b=S((function(e){return e.user})),m=S((function(e){return e.limit})),p=S((function(e){return e.dispatch}));Object(a.useEffect)((function(){e.likes.filter((function(e){return e.username===b.username}))[0]&&o&&(s("Remove Like"),u(!1))}));return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)(U.a.Text,{children:["Number of Likes: ",e.likes.length]}),Object(N.jsx)(J.a,{onClick:function(){"Like"===r?function(e,t){return fetch(d+"likes",{method:"POST",headers:{Authorization:"Bearer "+t,"Content-Type":"application/json"},body:JSON.stringify({messageId:e})})}(e.id,b.token).then(s("Remove Like")):function(e,t){return fetch("".concat(d,"likes/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer "+t}}).then((function(e){return e.json()}))}(l.filter((function(t){return t.id===e.id}))[0].likes.filter((function(e){return e.username===b.username}))[0].id,b.token).then(s("Like"));setTimeout((function(){h(m,0).then((function(e){p({type:g,payload:{messages:e.messages}})}))}),700)},children:r})]})},G=function(e){var t=S((function(e){return e.user})),n=S((function(e){return e.dispatch})),r=S((function(e){return e.limit})),s=Object(a.useState)(),c=Object(j.a)(s,2),i=c[0],o=c[1],u=Object(a.useState)(!1),b=Object(j.a)(u,2),m=b[0],p=b[1];Object(a.useEffect)((function(){var n;(n=e.username,fetch(d+"users/".concat(n,"/picture")).then((function(e){return e.blob()}))).then((function(e){if("image/jpeg"===e.type||"image/png"===e.type||"image/gif"===e.type){var t=URL.createObjectURL(e);return e.src=t,o(e)}})),e.username===t.username&&p(!0)}),[]);return Object(N.jsx)("div",{id:"MessageFeed",children:Object(N.jsx)("div",{id:"message-".concat(e.id),children:Object(N.jsxs)(U.a,{style:{width:"90%",height:"auto"},children:[Object(N.jsx)(U.a.Img,{variant:"top",src:i&&i.src}),Object(N.jsxs)(U.a.Body,{children:[Object(N.jsx)(U.a.Title,{children:e.username}),Object(N.jsxs)(U.a.Text,{children:[Object(N.jsx)("textarea",{readOnly:!0,type:"text",value:e.value}),m&&Object(N.jsx)(J.a,{onClick:function(){var a,s;a=e.id,s=t.token,fetch("".concat(d,"messages/").concat(a),{method:"DELETE",headers:{Authorization:"Bearer "+s}}).then((function(e){return e.json()})),setTimeout((function(){h(r,0).then((function(e){n({type:g,payload:{messages:e.messages}})}))}),500)},children:"Delete Message"}),Object(N.jsx)(M,{likes:e.likes,id:e.id})]}),Object(N.jsx)(l.b,{to:"/profile/".concat(e.username),children:Object(N.jsxs)(J.a,{children:[e.username,"'s Profile"]})})]})]})})})},_=function(){var e=S((function(e){return e.messages})),t=S((function(e){return e.limit})),n=S((function(e){return e.dispatch}));return Object(a.useEffect)((function(){n({type:y,payload:{limit:15}}),h(t,0).then((function(e){return n({type:g,payload:{messages:e.messages}})}))}),[]),Object(N.jsx)("div",{id:"messages",children:Object(N.jsx)("ul",{children:e&&e.map((function(e){return Object(N.jsx)(G,{value:e.text,username:e.username,likes:e.likes,id:e.id},e.id)}))})})},K=function(){var e=S((function(e){return e.messages})),t=S((function(e){return e.dispatch})),n=e.sort((function(e,t){return e.likes.length>t.likes.length?-1:e.likes.length<t.likes.length?1:0})).slice(0,10);return Object(a.useEffect)((function(){t({type:y,payload:{limit:100}})}),[]),Object(N.jsx)("div",{id:"messages",children:Object(N.jsx)("ul",{children:e&&n.map((function(e){return Object(N.jsx)(G,{value:e.text,username:e.username,likes:e.likes,id:e.id},e.id)}))})})},H=function(e){var t=S((function(e){return e.messages})),n=S((function(e){return e.user})),r=S((function(e){return e.limit})),s=S((function(e){return e.isRedirecting})),c=S((function(e){return e.dispatch})),o=Object(a.useState)(""),u=Object(j.a)(o,2),l=u[0],b=u[1],m="/topten"===e.match.path?Object(N.jsx)(K,{}):Object(N.jsx)(_,{});return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(P,{}),Object(N.jsxs)("form",{id:"message-form",onSubmit:function(e){var t,a;e.preventDefault(),(t=n.token,a=l,fetch(d+"messages",{method:"POST",headers:{Authorization:"Bearer "+t,"Content-Type":"application/json"},body:JSON.stringify({text:a})}).then((function(e){return e.json()}))).then(b("")).then(h(r,0).then((function(e){return c({type:g,payload:{messages:e.messages}})})))},children:[Object(N.jsx)("textarea",{type:"text",required:!0,value:l,placeholder:"What do you want to say?",onChange:function(e){b(e.target.value)}}),Object(N.jsx)("button",{type:"submit",children:"Post"})]}),t&&m,!s&&Object(N.jsx)(i.a,{to:"/"})]})};var V=function(){return Object(N.jsx)("div",{className:"App",children:Object(N.jsxs)(i.d,{children:[Object(N.jsx)(i.b,{exact:!0,path:"/",component:E}),Object(N.jsx)(i.b,{path:"/register",component:L}),Object(N.jsx)(i.b,{path:"/profile/:username",component:q}),Object(N.jsx)(i.b,{path:"/messages",component:H}),Object(N.jsx)(i.b,{path:"/topten",component:H}),Object(N.jsx)(i.b,{component:T})]})})};c.a.render(Object(N.jsx)(r.a.StrictMode,{children:Object(N.jsx)(l.a,{basename:"/kwitter-zaska-afk",children:Object(N.jsx)(V,{})})}),document.getElementById("root"))}},[[52,1,2]]]);
//# sourceMappingURL=main.2bc36e45.chunk.js.map