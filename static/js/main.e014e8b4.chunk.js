(this["webpackJsonpkwitter-starter"]=this["webpackJsonpkwitter-starter"]||[]).push([[0],{40:function(e,t,n){},44:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(18),c=n.n(s),i=(n(40),n(6)),o=n(17),u=n(4),j=n(5),l=n(8),d="https://socialapp-api.herokuapp.com/",b=function(e,t){return fetch(d+"auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})}).then((function(e){return e.json()}))},h=function(){return fetch("".concat(d,"messages?limit=",100,"&offset=",0)).then((function(e){return e.json()}))},m=n(35),p=n(33),O=n(27),f={LOGOUT:"LOGOUT",LOGIN:"LOGIN",SET_MESSAGES:"SET_MESSAGES",SET_REDIRECTING:"SET_REDIRECTING",ADD_LIKE:"ADD_LIKE",REMOVE_LIKE:"REMOVE_LIKE"},x=Object(p.a)(Object(O.devtools)(Object(O.redux)((function(e,t){switch(t.type){case f.LOGIN:return Object(u.a)(Object(u.a)({},e),{},{user:{username:t.payload.username,token:t.payload.token}});case f.LOGOUT:return Object(u.a)(Object(u.a)({},e),{},{user:{}});case f.SET_MESSAGES:return Object(u.a)(Object(u.a)({},e),{},{messages:t.payload.messages});case f.SET_REDIRECTING:return Object(u.a)(Object(u.a)({},e),{},{isRedirecting:!e.isRedirecting});case f.ADD_LIKE:return console.log(t.payload),Object(u.a)(Object(u.a)({},e),{},{likes:[].concat(Object(m.a)(e.likes),[t.payload.like])});case f.REMOVE_LIKE:return Object(u.a)(Object(u.a)({},e),{},{likes:t.payload.likes});default:return e}}),{user:{token:""},messages:[],isRedirecting:!1}))),g=(n(44),n(1));var v=function(){var e=x((function(e){return e.dispatch})),t=x((function(e){return e.isRedirecting})),n=Object(a.useState)({username:"",password:""}),r=Object(j.a)(n,2),s=r[0],c=r[1];Object(a.useEffect)((function(){return window.addEventListener("message",d),function(){window.removeEventListener("message",d)}}),[]);var d=function(t){void 0!==t.data.username&&(e({type:f.LOGIN,payload:t.data}),e({type:f.SET_REDIRECTING}))},h=function(e){var t=e.target.name,n=e.target.value;c((function(e){return Object(u.a)(Object(u.a)({},e),{},Object(o.a)({},t,n))}))};return Object(g.jsx)(g.Fragment,{children:Object(g.jsxs)("div",{id:"login",children:[Object(g.jsxs)("form",{id:"login-form",onSubmit:function(t){t.preventDefault(),b(s.username,s.password).then((function(t){return void 0===t.message?e({type:f.LOGIN,payload:t}):(alert(t.message),!1)})).then((function(t){t&&e({type:f.SET_REDIRECTING})}))},children:[Object(g.jsx)("label",{htmlFor:"username",children:"Username"}),Object(g.jsx)("input",{type:"text",name:"username",value:s.username,autoFocus:!0,required:!0,onChange:h}),Object(g.jsx)("label",{htmlFor:"password",children:"Password"}),Object(g.jsx)("input",{type:"password",name:"password",value:s.password,required:!0,onChange:h}),Object(g.jsx)("button",{type:"submit",children:"Login"}),Object(g.jsx)("button",{onClick:function(e){window.open("https://socialapp-api.herokuapp.com/auth/google/login")},children:"Login with Google"}),Object(g.jsxs)("p",{children:["Don't have an account? Sign up ",Object(g.jsx)(l.b,{to:"/register",children:"here!"})]})]}),t&&Object(g.jsx)(i.a,{to:"/messages"})]})})};var y=function(e){return Object(g.jsx)(g.Fragment,{children:Object(g.jsxs)("div",{id:"title",children:[Object(g.jsx)("div",{id:"menu",children:Object(g.jsx)("h1",{id:"header",children:"Kwitter"})}),Object(g.jsx)(v,{})]})})},E=function(e){var t=x((function(e){return e.dispatch})),n=x((function(e){return e.isRedirecting})),r=Object(a.useState)({username:"",displayName:"",password:""}),s=Object(j.a)(r,2),c=s[0],h=s[1],m=function(e){var t=e.target.name,n=e.target.value;h((function(e){return Object(u.a)(Object(u.a)({},e),{},Object(o.a)({},t,n))}))};return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("form",{id:"signup-form",onSubmit:function(e){var n,a,r;e.preventDefault(),(n=c.username,a=c.password,r=c.displayName,fetch(d+"users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,displayName:r,password:a})}).then((function(e){return e.json()}))).then((function(){return b(c.username,c.password)})).then((function(e){return void 0===e.message?t({type:f.LOGIN,payload:e}):(alert(e.message),!1)})).then((function(e){if(e)return t({type:f.SET_REDIRECTING})}))},children:[Object(g.jsx)("label",{htmlFor:"username",children:"Username"}),Object(g.jsx)("input",{type:"text",name:"username",value:c.username,autoFocus:!0,required:!0,onChange:m}),Object(g.jsx)("label",{htmlFor:"displayName",children:"Display Name"}),Object(g.jsx)("input",{type:"text",name:"displayName",value:c.displayName,required:!0,onChange:m}),Object(g.jsx)("label",{htmlFor:"password",children:"Password"}),Object(g.jsx)("input",{type:"password",name:"password",value:c.password,required:!0,onChange:m}),Object(g.jsx)("button",{type:"submit",children:"Sign Up"})]}),Object(g.jsxs)("p",{children:["Already have an account? Login ",Object(g.jsx)(l.b,{to:"/",children:"here!"}),n&&Object(g.jsx)(i.a,{to:"/"})]})]})};var S=function(e){return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("p",{children:["Page not found for ",e.location.pathname]}),Object(g.jsx)(l.b,{to:"/",children:"Go Home"})]})},k=n(30);n(24);var T=function(e){var t=x((function(e){return e.user})),n=x((function(e){return e.dispatch}));return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(k.a,{fixed:"top"}),Object(g.jsx)(k.a,{bg:"dark",variant:"dark"}),Object(g.jsx)("button",{onClick:function(e){var a;(a=t.token,fetch(d+"auth/logout",{headers:{Authorization:"Bearer "+a}}).then((function(e){return e.json()}))).then((function(){return n({type:f.LOGOUT})})).then(n({type:f.SET_REDIRECTING})).then((function(){return n({type:f.SET_LIMIT,payload:{limit:15}})}))},children:"Logout"}),Object(g.jsx)(l.b,{to:"/profile/".concat(t.username),children:Object(g.jsx)("button",{children:"Profile"})}),Object(g.jsx)(l.b,{to:"/messages",children:Object(g.jsx)("button",{children:"Message Board"})}),Object(g.jsx)(l.b,{to:"/topten",children:Object(g.jsx)("button",{children:"Top Posts"})})]})},N=function(e){var t=e.onChange,n=e.src;return Object(g.jsxs)("label",{htmlFor:"photo-upload",className:"custom-file-upload fas",children:[Object(g.jsx)("div",{className:"img-wrap img-upload",children:Object(g.jsx)("img",{for:"photo-upload",src:n})}),Object(g.jsx)("input",{id:"photo-upload",type:"file",onChange:t})]})},w=function(e){var t=e.onChange,n=e.value;return Object(g.jsxs)("div",{className:"field",children:[Object(g.jsx)("label",{htmlFor:"name",children:"name:"}),Object(g.jsx)("input",{id:"name",type:"text",onChange:t,minLength:"3",maxLength:"20",value:n,required:!0})]})},L=function(e){var t=e.onChange,n=e.value;return Object(g.jsxs)("div",{className:"field",children:[Object(g.jsx)("label",{htmlFor:"status",children:"status:"}),Object(g.jsx)("input",{id:"status",type:"text",onChange:t,maxLength:"255",value:n,required:!0})]})},C=function(e){var t=e.onChange,n=e.value;return Object(g.jsxs)("div",{className:"field",children:[Object(g.jsx)("label",{htmlFor:"password",children:"Password:"}),Object(g.jsx)("input",{id:"password",type:"password",onChange:t,minLength:"3",maxLength:"20",value:n,required:!0})]})},I=function(e){var t=e.onSubmit,n=e.src,a=e.name,r=e.status,s=e.canEdit,c=e.username;return Object(g.jsx)(g.Fragment,{children:Object(g.jsxs)("div",{className:"profilecard",children:[Object(g.jsxs)("h3",{children:[a,"'s Profile Page"]}),Object(g.jsxs)("form",{onSubmit:t,children:[Object(g.jsx)("label",{className:"custom-file-upload fas",children:Object(g.jsx)("div",{className:"img-wrap",children:Object(g.jsx)("img",{width:"200px",for:"photo-upload",src:n,alt:"".concat(c,"'s Profile Picture")})})}),Object(g.jsx)("div",{className:"name",children:a}),Object(g.jsxs)("div",{className:"username",children:["@",c]}),Object(g.jsx)("div",{className:"status",children:r}),s&&Object(g.jsxs)("button",{type:"submit",className:"edit",children:["Edit Profile"," "]})]})]})})},R=function(e){var t=e.onSubmit,n=e.changeActive,a=e.children,r=e.handleDelete;return Object(g.jsx)("div",{className:"profilecard",children:Object(g.jsxs)("form",{onSubmit:t,children:[a,Object(g.jsxs)("button",{type:"submit",className:"save",children:["Save"," "]}),Object(g.jsx)("button",{onClick:r,children:"Delete Account"}),Object(g.jsx)("button",{onClick:n,children:"Back"})]})})};var D=function(e){var t=Object(a.useState)(""),n=Object(j.a)(t,2),r=n[0],s=n[1],c=Object(a.useState)(""),o=Object(j.a)(c,2),l=o[0],b=o[1],h=Object(a.useState)(""),m=Object(j.a)(h,2),p=m[0],O=m[1],v=Object(a.useState)(""),y=Object(j.a)(v,2),E=y[0],S=y[1],k=Object(a.useState)(!1),D=Object(j.a)(k,2),G=D[0],A=D[1],F=Object(a.useState)(!1),_=Object(j.a)(F,2),P=_[0],M=_[1],B=Object(a.useState)({password:"",displayName:"",about:""}),U=Object(j.a)(B,2),z=U[0],q=U[1],K=x((function(e){return e.isRedirecting})),J=x((function(e){return e.user})),V=x((function(e){return e.dispatch}));function H(e){var t=new FileReader,n=e.target.files[0];t.onloadend=function(){n.size<=2e5?(S(t.result),function(e,t,n){var a=new FormData;a.append("picture",t),fetch(d+"users/".concat(e,"/picture"),{method:"PUT",headers:{Authorization:"Bearer "+n},body:a})}(J.username,n,J.token)):alert("Image cannot be larger than 200KB")},t.readAsDataURL(n)}function W(e){e.preventDefault(),function(e,t,n,a,r){return fetch(d+"users/".concat(e),{method:"PATCH",headers:{Authorization:"Bearer "+r,"Content-Type":"application/json"},body:JSON.stringify({password:t,about:n,displayName:a})}).then((function(e){return e.json()}))}(J.username,z.password,z.about,z.displayName,J.token).then((function(e){if(200===e.statusCode){var t=e.user;s(t.displayName),b(t.username),O(t.about),S("https://socialapp-api.herokuapp.com".concat(t.pictureLocation)),q({password:"",displayName:"",about:"",picture:{}})}})),A((function(e){return!e}))}function Q(e){(function(e,t){return fetch(d+"users/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer "+t}}).then((function(e){return e.json()}))})(J.username,J.token).then(V({type:f.LOGOUT})).then(V({type:f.SET_REDIRECTING}))}function X(){A((function(e){return!e}))}return Object(a.useEffect)((function(){(function(e){return fetch(d+"users/".concat(e)).then((function(e){return e.json()}))})(e.location.pathname.slice(9)).then((function(e){e.user.username===J.username&&M(!0),s(e.user.displayName),b(e.user.username),S("https://socialapp-api.herokuapp.com".concat(e.user.pictureLocation)),O(e.user.about)}))}),[e.location.pathname]),Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(T,{}),Object(g.jsx)("div",{className:"profilebody",children:G?Object(g.jsxs)(R,{onSubmit:function(e){return W(e)},changeActive:function(e){return X()},handleDelete:function(e){return Q()},children:[Object(g.jsx)(N,{onChange:function(e){return H(e)},src:E}),Object(g.jsx)(w,{onChange:function(e){return function(e){var t=e.target.value;q((function(e){return Object(u.a)(Object(u.a)({},e),{},{displayName:t})}))}(e)},value:z.displayName}),Object(g.jsx)(C,{onChange:function(e){return function(e){var t=e.target.value;q((function(e){return Object(u.a)(Object(u.a)({},e),{},{password:t})}))}(e)},value:z.password}),Object(g.jsx)(L,{onChange:function(e){return function(e){var t=e.target.value;q((function(e){return Object(u.a)(Object(u.a)({},e),{},{about:t})}))}(e)},value:z.about})]}):Object(g.jsx)(I,{onSubmit:function(e){return X()},src:E,name:r,username:l,status:p,canEdit:P})}),!K&&Object(g.jsx)(i.a,{to:"/"})]})},G=(n(51),n(15)),A=n(20),F=function(e){var t=Object(a.useState)("Like"),n=Object(j.a)(t,2),r=n[0],s=n[1],c=Object(a.useState)(!0),i=Object(j.a)(c,2),o=i[0],u=i[1],l=x((function(e){return e.messages})),b=x((function(e){return e.user})),m=x((function(e){return e.dispatch}));Object(a.useEffect)((function(){e.likes.filter((function(e){return e.username===b.username}))[0]&&o&&(s("Remove Like"),u(!1))}));return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)(G.a.Text,{children:["Number of Likes: ",e.likes.length]}),Object(g.jsx)(A.a,{onClick:function(){"Like"===r?function(e,t){return fetch(d+"likes",{method:"POST",headers:{Authorization:"Bearer "+t,"Content-Type":"application/json"},body:JSON.stringify({messageId:e})})}(e.id,b.token).then(s("Remove Like")):function(e,t){return fetch("".concat(d,"likes/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer "+t}}).then((function(e){return e.json()}))}(l.filter((function(t){return t.id===e.id}))[0].likes.filter((function(e){return e.username===b.username}))[0].id,b.token).then(s("Like"));setTimeout((function(){h().then((function(e){m({type:f.SET_MESSAGES,payload:{messages:e.messages}})}))}),700)},children:r})]})},_=function(e){var t=x((function(e){return e.user})),n=x((function(e){return e.dispatch})),r=(x((function(e){return e.limit})),Object(a.useState)()),s=Object(j.a)(r,2),c=s[0],i=s[1],o=Object(a.useState)(!1),u=Object(j.a)(o,2),b=u[0],m=u[1];Object(a.useEffect)((function(){var n;(n=e.username,fetch(d+"users/".concat(n,"/picture")).then((function(e){return e.blob()}))).then((function(e){if("image/jpeg"===e.type||"image/png"===e.type||"image/gif"===e.type){var t=URL.createObjectURL(e);return e.src=t,i(e)}})),e.username===t.username&&m(!0)}),[]);return Object(g.jsx)("div",{id:"MessageFeed",children:Object(g.jsx)("div",{id:"message-".concat(e.id),children:Object(g.jsxs)(G.a,{style:{width:"90%",height:"auto"},children:[Object(g.jsx)(G.a.Img,{variant:"top",src:c&&c.src}),Object(g.jsxs)(G.a.Body,{children:[Object(g.jsx)(G.a.Title,{children:e.username}),Object(g.jsxs)(G.a.Text,{children:[Object(g.jsx)("textarea",{readOnly:!0,type:"text",value:e.value}),b&&Object(g.jsx)(A.a,{onClick:function(){var a,r;a=e.id,r=t.token,fetch("".concat(d,"messages/").concat(a),{method:"DELETE",headers:{Authorization:"Bearer "+r}}).then((function(e){return e.json()})),setTimeout((function(){h().then((function(e){n({type:f.SET_MESSAGES,payload:{messages:e.messages}})}))}),500)},children:"Delete Message"}),Object(g.jsx)(F,{likes:e.likes,id:e.id})]}),Object(g.jsx)(l.b,{to:"/profile/".concat(e.username),children:Object(g.jsxs)(A.a,{children:[e.username,"'s Profile"]})})]})]})})})},P=function(){var e=x((function(e){return e.messages})),t=x((function(e){return e.dispatch})),n=e.slice(0,15);return Object(a.useEffect)((function(){h().then((function(e){return t({type:f.SET_MESSAGES,payload:{messages:e.messages}})}))}),[]),Object(g.jsx)("div",{id:"messages",children:Object(g.jsx)("ul",{children:e&&n.map((function(e){return Object(g.jsx)(_,{value:e.text,username:e.username,likes:e.likes,id:e.id},e.id)}))})})},M=function(){var e=x((function(e){return e.messages})),t=x((function(e){return e.dispatch})),n=e.sort((function(e,t){return e.likes.length>t.likes.length?-1:e.likes.length<t.likes.length?1:0})).slice(0,10);return Object(a.useEffect)((function(){h().then((function(e){return t({type:f.SET_MESSAGES,payload:{messages:e.messages}})}))}),[]),Object(g.jsx)("div",{id:"messages",children:Object(g.jsx)("ul",{children:e&&n.map((function(e){return Object(g.jsx)(_,{value:e.text,username:e.username,likes:e.likes,id:e.id},e.id)}))})})},B=function(e){var t=x((function(e){return e.messages})),n=x((function(e){return e.user})),r=(x((function(e){return e.limit})),x((function(e){return e.isRedirecting}))),s=x((function(e){return e.dispatch})),c=Object(a.useState)(""),o=Object(j.a)(c,2),u=o[0],l=o[1],b="/topten"===e.match.path?Object(g.jsx)(M,{}):Object(g.jsx)(P,{});return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(T,{}),Object(g.jsxs)("form",{id:"message-form",onSubmit:function(e){var t,a;e.preventDefault(),(t=n.token,a=u,fetch(d+"messages",{method:"POST",headers:{Authorization:"Bearer "+t,"Content-Type":"application/json"},body:JSON.stringify({text:a})}).then((function(e){return e.json()}))).then(l("")).then(setTimeout((function(){h().then((function(e){s({type:f.SET_MESSAGES,payload:{messages:e.messages}})}))}),500))},children:[Object(g.jsx)("textarea",{type:"text",required:!0,value:u,placeholder:"What do you want to say?",onChange:function(e){l(e.target.value)}}),Object(g.jsx)("button",{type:"submit",children:"Post"})]}),t&&b,!r&&Object(g.jsx)(i.a,{to:"/"})]})};var U=function(){return Object(g.jsx)("div",{className:"App",children:Object(g.jsxs)(i.d,{children:[Object(g.jsx)(i.b,{exact:!0,path:"/",component:y}),Object(g.jsx)(i.b,{path:"/register",component:E}),Object(g.jsx)(i.b,{path:"/profile/:username",component:D}),Object(g.jsx)(i.b,{path:"/messages",component:B}),Object(g.jsx)(i.b,{path:"/topten",component:B}),Object(g.jsx)(i.b,{component:S})]})})};c.a.render(Object(g.jsx)(r.a.StrictMode,{children:Object(g.jsx)(l.a,{basename:"/kwitter-zaska-afk",children:Object(g.jsx)(U,{})})}),document.getElementById("root"))}},[[52,1,2]]]);
//# sourceMappingURL=main.e014e8b4.chunk.js.map